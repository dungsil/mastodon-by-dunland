(window.webpackJsonp=window.webpackJsonp||[]).push([[48],{822:function(t,e,s){"use strict";s.r(e),s.d(e,"default",(function(){return Mt}));var a=s(0),i=s(3),o=s(1),n=s.n(o),l=s(13),d=s(2),c=s.n(d),r=s(9),h=s.n(r),u=s(15),p=s.n(u),g=s(46),m=s(25),b=s(759),f=s(96),v=s(34),O=s(50),k=s(131),M=s(510),j=s(86),_=s(4),y=s(212),C=s(16),I=s(47),x=s(117),w=s(189),D=s(14),R=s(211),T=s(319),H=s(104),N=s(152),U=s(318);var E,B=Object(l.connect)(((t,e)=>{let{statusId:s}=e;return{dropdownPlacement:t.getIn(["dropdown_menu","placement"]),openDropdownId:t.getIn(["dropdown_menu","openId"]),openedViaKeyboard:t.getIn(["dropdown_menu","keyboard"]),items:t.getIn(["history",s,"items"]),loading:t.getIn(["history",s,"loading"])}}),((t,e)=>{let{statusId:s}=e;return{onOpen(e,a,i,o){t(Object(N.d)(s)),t(Object(H.d)(e,i,o))},onClose(e){t(Object(H.c)(e))}}}))(U.a),P=s(17),V=s(72),F=s(781);let S=Object(l.connect)(null,((t,e)=>{let{statusId:s}=e;return{onItemClick(e){t(Object(P.d)("COMPARE_HISTORY",{index:e,statusId:s}))}}}))(E=Object(_.g)(E=class extends n.a.PureComponent{constructor(){super(...arguments),this.handleItemClick=(t,e)=>{const{onItemClick:s}=this.props;s(e)},this.renderHeader=t=>Object(a.a)(_.b,{id:"status.edited_x_times",defaultMessage:"Edited {count, plural, one {{count} time} other {{count} times}}",values:{count:t.size-1}}),this.renderItem=(t,e,s)=>{let{onClick:i,onKeyPress:o}=s;const n=Object(a.a)(V.default,{timestamp:t.get("created_at"),short:!1}),l=Object(a.a)(F.a,{accountId:t.get("account")}),d=t.get("original")?Object(a.a)(_.b,{id:"status.history.created",defaultMessage:"{name} created {date}",values:{name:l,date:n}}):Object(a.a)(_.b,{id:"status.history.edited",defaultMessage:"{name} edited {date}",values:{name:l,date:n}});return Object(a.a)("li",{className:"dropdown-menu__item edited-timestamp__history__item"},t.get("created_at"),Object(a.a)("button",{"data-index":e,onClick:i,onKeyPress:o},void 0,d))}}render(){const{timestamp:t,intl:e,statusId:s}=this.props;return Object(a.a)(B,{statusId:s,renderItem:this.renderItem,scrollable:!0,renderHeader:this.renderHeader,onItemClick:this.handleItemClick},void 0,Object(a.a)("button",{className:"dropdown-menu__text-button"},void 0,Object(a.a)(_.b,{id:"status.edited",defaultMessage:"Edited {date}",values:{date:e.formatDate(t,{hour12:!1,month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"})}})," ",Object(a.a)(D.a,{id:"caret-down"})))}})||E)||E;var A,z;const q=Object(_.f)({public_short:{id:"privacy.public.short",defaultMessage:"Public"},unlisted_short:{id:"privacy.unlisted.short",defaultMessage:"Unlisted"},private_short:{id:"privacy.private.short",defaultMessage:"Followers-only"},direct_short:{id:"privacy.direct.short",defaultMessage:"Direct"}});let $=Object(_.g)(((z=class extends C.a{constructor(){super(...arguments),this.state={height:null},this.handleAccountClick=t=>{0!==t.button||t.ctrlKey||t.metaKey||!this.context.router||(t.preventDefault(),this.context.router.history.push("/@"+this.props.status.getIn(["account","acct"]))),t.stopPropagation()},this.handleOpenVideo=t=>{this.props.onOpenVideo(this.props.status.getIn(["media_attachments",0]),t)},this.handleExpandedToggle=()=>{this.props.onToggleHidden(this.props.status)},this.setRef=t=>{this.node=t,this._measureHeight()},this.handleModalLink=t=>{let e;t.preventDefault(),e="A"!==t.target.nodeName?t.target.parentNode.href:t.target.href,window.open(e,"mastodon-intent","width=445,height=600,resizable=no,menubar=no,status=no,scrollbars=yes")},this.handleTranslate=()=>{const{onTranslate:t,status:e}=this.props;t(e)}}_measureHeight(t){this.props.measureHeight&&this.node&&(Object(w.a)((()=>this.node&&this.setState({height:Math.ceil(this.node.scrollHeight)+1}))),this.props.onHeightChange&&t&&this.props.onHeightChange())}componentDidUpdate(t,e){this._measureHeight(e.height!==this.state.height)}render(){const t=this.props.status&&this.props.status.get("reblog")?this.props.status.get("reblog"):this.props.status,e={boxSizing:"border-box"},{intl:s,compact:i,pictureInPicture:o}=this.props;if(!t)return null;let l="",d="",c="",r="retweet",u="",p="";if(this.props.measureHeight&&(e.height=this.state.height+"px"),o.get("inUse"))l=Object(a.a)(T.a,{});else if(t.get("media_attachments").size>0)if("audio"===t.getIn(["media_attachments",0,"type"])){const e=t.getIn(["media_attachments",0]);l=Object(a.a)(x.default,{src:e.get("url"),alt:e.get("description"),duration:e.getIn(["meta","original","duration"],0),poster:e.get("preview_url")||t.getIn(["account","avatar_static"]),backgroundColor:e.getIn(["meta","colors","background"]),foregroundColor:e.getIn(["meta","colors","foreground"]),accentColor:e.getIn(["meta","colors","accent"]),sensitive:t.get("sensitive"),visible:this.props.showMedia,blurhash:e.get("blurhash"),height:150,onToggleVisibility:this.props.onToggleMediaVisibility})}else if("video"===t.getIn(["media_attachments",0,"type"])){const e=t.getIn(["media_attachments",0]);l=Object(a.a)(I.default,{preview:e.get("preview_url"),frameRate:e.getIn(["meta","original","frame_rate"]),blurhash:e.get("blurhash"),src:e.get("url"),alt:e.get("description"),width:300,height:150,inline:!0,onOpenVideo:this.handleOpenVideo,sensitive:t.get("sensitive"),visible:this.props.showMedia,onToggleVisibility:this.props.onToggleMediaVisibility})}else l=Object(a.a)(M.default,{standalone:!0,sensitive:t.get("sensitive"),media:t.get("media_attachments"),height:300,onOpenMedia:this.props.onOpenMedia,visible:this.props.showMedia,onToggleVisibility:this.props.onToggleMediaVisibility});else 0===t.get("spoiler_text").length&&(l=Object(a.a)(y.a,{sensitive:t.get("sensitive"),onOpenMedia:this.props.onOpenMedia,card:t.get("card",null)}));t.get("application")&&(d=Object(a.a)(n.a.Fragment,{},void 0," · ",Object(a.a)("a",{className:"detailed-status__application",href:t.getIn(["application","website"]),target:"_blank",rel:"noopener noreferrer"},void 0,t.getIn(["application","name"]))));const g={public:{icon:"globe",text:s.formatMessage(q.public_short)},unlisted:{icon:"unlock",text:s.formatMessage(q.unlisted_short)},private:{icon:"lock",text:s.formatMessage(q.private_short)},direct:{icon:"at",text:s.formatMessage(q.direct_short)}}[t.get("visibility")],m=Object(a.a)(n.a.Fragment,{},void 0," · ",Object(a.a)(D.a,{id:g.icon,title:g.text}));return c=["private","direct"].includes(t.get("visibility"))?"":this.context.router?Object(a.a)(n.a.Fragment,{},void 0,Object(a.a)(n.a.Fragment,{},void 0," · "),Object(a.a)(j.a,{to:`/@${t.getIn(["account","acct"])}/${t.get("id")}/reblogs`,className:"detailed-status__link"},void 0,Object(a.a)(D.a,{id:r}),Object(a.a)("span",{className:"detailed-status__reblogs"},void 0,Object(a.a)(R.a,{value:t.get("reblogs_count")})))):Object(a.a)(n.a.Fragment,{},void 0,Object(a.a)(n.a.Fragment,{},void 0," · "),Object(a.a)("a",{href:`/interact/${t.get("id")}?type=reblog`,className:"detailed-status__link",onClick:this.handleModalLink},void 0,Object(a.a)(D.a,{id:r}),Object(a.a)("span",{className:"detailed-status__reblogs"},void 0,Object(a.a)(R.a,{value:t.get("reblogs_count")})))),u=this.context.router?Object(a.a)(j.a,{to:`/@${t.getIn(["account","acct"])}/${t.get("id")}/favourites`,className:"detailed-status__link"},void 0,Object(a.a)(D.a,{id:"star"}),Object(a.a)("span",{className:"detailed-status__favorites"},void 0,Object(a.a)(R.a,{value:t.get("favourites_count")}))):Object(a.a)("a",{href:`/interact/${t.get("id")}?type=favourite`,className:"detailed-status__link",onClick:this.handleModalLink},void 0,Object(a.a)(D.a,{id:"star"}),Object(a.a)("span",{className:"detailed-status__favorites"},void 0,Object(a.a)(R.a,{value:t.get("favourites_count")}))),t.get("edited_at")&&(p=Object(a.a)(n.a.Fragment,{},void 0,Object(a.a)(n.a.Fragment,{},void 0," · "),Object(a.a)(S,{statusId:t.get("id"),timestamp:t.get("edited_at")}))),Object(a.a)("div",{style:e},void 0,n.a.createElement("div",{ref:this.setRef,className:h()("detailed-status","detailed-status-"+t.get("visibility"),{compact:i})},Object(a.a)("a",{href:"/@"+t.getIn(["account","acct"]),onClick:this.handleAccountClick,className:"detailed-status__display-name"},void 0,Object(a.a)("div",{className:"detailed-status__display-avatar"},void 0,Object(a.a)(v.a,{account:t.get("account"),size:46})),Object(a.a)(O.a,{account:t.get("account"),localDomain:this.props.domain})),Object(a.a)(k.a,{status:t,expanded:!t.get("hidden"),onExpandedToggle:this.handleExpandedToggle,onTranslate:this.handleTranslate}),l,Object(a.a)("div",{className:"detailed-status__meta"},void 0,Object(a.a)("a",{className:"detailed-status__datetime",href:`/@${t.getIn(["account","acct"])}/${t.get("id")}`,target:"_blank",rel:"noopener noreferrer"},void 0,Object(a.a)(_.a,{value:new Date(t.get("created_at")),hour12:!1,year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"})),p,m,d,c," · ",u)))}}).contextTypes={router:c.a.object},z.propTypes={status:p.a.map,onOpenMedia:c.a.func.isRequired,onOpenVideo:c.a.func.isRequired,onToggleHidden:c.a.func.isRequired,onTranslate:c.a.func.isRequired,measureHeight:c.a.bool,onHeightChange:c.a.func,domain:c.a.string.isRequired,compact:c.a.bool,showMedia:c.a.bool,pictureInPicture:p.a.contains({inUse:c.a.bool,available:c.a.bool}),onToggleMediaVisibility:c.a.func},A=z))||A;var L,K,J=s(18),Y=s(99),W=s(7),G=s(76);const Q=Object(_.f)({delete:{id:"status.delete",defaultMessage:"Delete"},redraft:{id:"status.redraft",defaultMessage:"Delete & re-draft"},edit:{id:"status.edit",defaultMessage:"Edit"},direct:{id:"status.direct",defaultMessage:"Direct message @{name}"},mention:{id:"status.mention",defaultMessage:"Mention @{name}"},reply:{id:"status.reply",defaultMessage:"Reply"},reblog:{id:"status.reblog",defaultMessage:"Boost"},reblog_private:{id:"status.reblog_private",defaultMessage:"Boost with original visibility"},cancel_reblog_private:{id:"status.cancel_reblog_private",defaultMessage:"Unboost"},cannot_reblog:{id:"status.cannot_reblog",defaultMessage:"This post cannot be boosted"},favourite:{id:"status.favourite",defaultMessage:"Favourite"},bookmark:{id:"status.bookmark",defaultMessage:"Bookmark"},more:{id:"status.more",defaultMessage:"More"},mute:{id:"status.mute",defaultMessage:"Mute @{name}"},muteConversation:{id:"status.mute_conversation",defaultMessage:"Mute conversation"},unmuteConversation:{id:"status.unmute_conversation",defaultMessage:"Unmute conversation"},block:{id:"status.block",defaultMessage:"Block @{name}"},report:{id:"status.report",defaultMessage:"Report @{name}"},share:{id:"status.share",defaultMessage:"Share"},pin:{id:"status.pin",defaultMessage:"Pin on profile"},unpin:{id:"status.unpin",defaultMessage:"Unpin from profile"},embed:{id:"status.embed",defaultMessage:"Embed"},admin_account:{id:"status.admin_account",defaultMessage:"Open moderation interface for @{name}"},admin_status:{id:"status.admin_status",defaultMessage:"Open this status in the moderation interface"},copy:{id:"status.copy",defaultMessage:"Copy link to status"},blockDomain:{id:"account.block_domain",defaultMessage:"Block domain {domain}"},unblockDomain:{id:"account.unblock_domain",defaultMessage:"Unblock domain {domain}"},unmute:{id:"account.unmute",defaultMessage:"Unmute @{name}"},unblock:{id:"account.unblock",defaultMessage:"Unblock @{name}"},openOriginalPage:{id:"account.open_original_page",defaultMessage:"Open original page"}});let X=Object(l.connect)(((t,e)=>{let{status:s}=e;return{relationship:t.getIn(["relationships",s.getIn(["account","id"])])}}))(L=Object(_.g)(((K=class extends n.a.PureComponent{constructor(){super(...arguments),this.handleReplyClick=()=>{this.props.onReply(this.props.status)},this.handleReblogClick=t=>{this.props.onReblog(this.props.status,t)},this.handleFavouriteClick=()=>{this.props.onFavourite(this.props.status)},this.handleBookmarkClick=t=>{this.props.onBookmark(this.props.status,t)},this.handleDeleteClick=()=>{this.props.onDelete(this.props.status,this.context.router.history)},this.handleRedraftClick=()=>{this.props.onDelete(this.props.status,this.context.router.history,!0)},this.handleEditClick=()=>{this.props.onEdit(this.props.status,this.context.router.history)},this.handleDirectClick=()=>{this.props.onDirect(this.props.status.get("account"),this.context.router.history)},this.handleMentionClick=()=>{this.props.onMention(this.props.status.get("account"),this.context.router.history)},this.handleMuteClick=()=>{const{status:t,relationship:e,onMute:s,onUnmute:a}=this.props,i=t.get("account");e&&e.get("muting")?a(i):s(i)},this.handleBlockClick=()=>{const{status:t,relationship:e,onBlock:s,onUnblock:a}=this.props,i=t.get("account");e&&e.get("blocking")?a(i):s(t)},this.handleBlockDomain=()=>{const{status:t,onBlockDomain:e}=this.props;e(t.get("account").get("acct").split("@")[1])},this.handleUnblockDomain=()=>{const{status:t,onUnblockDomain:e}=this.props;e(t.get("account").get("acct").split("@")[1])},this.handleConversationMuteClick=()=>{this.props.onMuteConversation(this.props.status)},this.handleReport=()=>{this.props.onReport(this.props.status)},this.handlePinClick=()=>{this.props.onPin(this.props.status)},this.handleShare=()=>{navigator.share({text:this.props.status.get("search_index"),url:this.props.status.get("url")})},this.handleEmbed=()=>{this.props.onEmbed(this.props.status)},this.handleCopy=()=>{const t=this.props.status.get("url");navigator.clipboard.writeText(t)}}render(){const{status:t,relationship:e,intl:s}=this.props,{signedIn:i,permissions:o}=this.context.identity,n=["public","unlisted"].includes(t.get("visibility")),l=["public","unlisted","private"].includes(t.get("visibility")),d=t.get("muted"),c=t.get("account"),r=t.getIn(["account","id"])===W.n,u=t.getIn(["account","username"])!==t.getIn(["account","acct"]);let p=[];if(n&&(u&&p.push({text:s.formatMessage(Q.openOriginalPage),href:t.get("url")}),p.push({text:s.formatMessage(Q.copy),action:this.handleCopy}),p.push({text:s.formatMessage(Q.embed),action:this.handleEmbed}),p.push(null)),r)l&&(p.push({text:s.formatMessage(t.get("pinned")?Q.unpin:Q.pin),action:this.handlePinClick}),p.push(null)),p.push({text:s.formatMessage(d?Q.unmuteConversation:Q.muteConversation),action:this.handleConversationMuteClick}),p.push(null),p.push({text:s.formatMessage(Q.edit),action:this.handleEditClick}),p.push({text:s.formatMessage(Q.delete),action:this.handleDeleteClick}),p.push({text:s.formatMessage(Q.redraft),action:this.handleRedraftClick});else{if(p.push({text:s.formatMessage(Q.mention,{name:t.getIn(["account","username"])}),action:this.handleMentionClick}),p.push(null),e&&e.get("muting")?p.push({text:s.formatMessage(Q.unmute,{name:c.get("username")}),action:this.handleMuteClick}):p.push({text:s.formatMessage(Q.mute,{name:c.get("username")}),action:this.handleMuteClick}),e&&e.get("blocking")?p.push({text:s.formatMessage(Q.unblock,{name:c.get("username")}),action:this.handleBlockClick}):p.push({text:s.formatMessage(Q.block,{name:c.get("username")}),action:this.handleBlockClick}),p.push({text:s.formatMessage(Q.report,{name:t.getIn(["account","username"])}),action:this.handleReport}),c.get("acct")!==c.get("username")){const t=c.get("acct").split("@")[1];p.push(null),e&&e.get("domain_blocking")?p.push({text:s.formatMessage(Q.unblockDomain,{domain:t}),action:this.handleUnblockDomain}):p.push({text:s.formatMessage(Q.blockDomain,{domain:t}),action:this.handleBlockDomain})}(o&G.c)===G.c&&(p.push(null),p.push({text:s.formatMessage(Q.admin_account,{name:t.getIn(["account","username"])}),href:"/admin/accounts/"+t.getIn(["account","id"])}),p.push({text:s.formatMessage(Q.admin_status),href:`/admin/accounts/${t.getIn(["account","id"])}/statuses/${t.get("id")}`}))}const g="share"in navigator&&n&&Object(a.a)("div",{className:"detailed-status__button"},void 0,Object(a.a)(J.a,{title:s.formatMessage(Q.share),icon:"share-alt",onClick:this.handleShare}));let m;m=null===t.get("in_reply_to_id",null)?"reply":"reply-all";const b=t.getIn(["account","id"])===W.n&&"private"===t.get("visibility");let f;return f=t.get("reblogged")?s.formatMessage(Q.cancel_reblog_private):n?s.formatMessage(Q.reblog):b?s.formatMessage(Q.reblog_private):s.formatMessage(Q.cannot_reblog),Object(a.a)("div",{className:"detailed-status__action-bar"},void 0,Object(a.a)("div",{className:"detailed-status__button"},void 0,Object(a.a)(J.a,{title:s.formatMessage(Q.reply),icon:t.get("in_reply_to_account_id")===t.getIn(["account","id"])?"reply":m,onClick:this.handleReplyClick})),Object(a.a)("div",{className:"detailed-status__button"},void 0,Object(a.a)(J.a,{className:h()({reblogPrivate:b}),disabled:!n&&!b,active:t.get("reblogged"),title:f,icon:"retweet",onClick:this.handleReblogClick})),Object(a.a)("div",{className:"detailed-status__button"},void 0,Object(a.a)(J.a,{className:"star-icon",animate:!0,active:t.get("favourited"),title:s.formatMessage(Q.favourite),icon:"star",onClick:this.handleFavouriteClick})),Object(a.a)("div",{className:"detailed-status__button"},void 0,Object(a.a)(J.a,{className:"bookmark-icon",disabled:!i,active:t.get("bookmarked"),title:s.formatMessage(Q.bookmark),icon:"bookmark",onClick:this.handleBookmarkClick})),g,Object(a.a)("div",{className:"detailed-status__action-bar-dropdown"},void 0,Object(a.a)(Y.a,{size:18,icon:"ellipsis-h",disabled:!i,status:t,items:p,direction:"left",title:s.formatMessage(Q.more)})))}}).contextTypes={router:c.a.object,identity:c.a.object},L=K))||L)||L;var Z,tt,et,st=s(753),at=s(23),it=s(11),ot=s(10),nt=s(36),lt=s(42),dt=s(57),ct=s(73),rt=s(130),ht=s(35),ut=s(206),pt=s(198),gt=s(751),mt=s(170),bt=s(129),ft=s(71),vt=s(214),Ot=s(95);const kt=Object(_.f)({deleteConfirm:{id:"confirmations.delete.confirm",defaultMessage:"Delete"},deleteMessage:{id:"confirmations.delete.message",defaultMessage:"Are you sure you want to delete this status?"},redraftConfirm:{id:"confirmations.redraft.confirm",defaultMessage:"Delete & redraft"},redraftMessage:{id:"confirmations.redraft.message",defaultMessage:"Are you sure you want to delete this status and re-draft it? Favourites and boosts will be lost, and replies to the original post will be orphaned."},revealAll:{id:"status.show_more_all",defaultMessage:"Show more for all"},hideAll:{id:"status.show_less_all",defaultMessage:"Show less for all"},detailedStatus:{id:"status.detailed_status",defaultMessage:"Detailed conversation view"},replyConfirm:{id:"confirmations.reply.confirm",defaultMessage:"Reply"},replyMessage:{id:"confirmations.reply.message",defaultMessage:"Replying now will overwrite the message you are currently composing. Are you sure you want to proceed?"},blockDomainConfirm:{id:"confirmations.domain_block.confirm",defaultMessage:"Hide entire domain"}});let Mt=(Z=Object(l.connect)((()=>{const t=Object(ht.h)(),e=Object(ht.f)(),s=Object(g.a)([(t,e)=>{let{id:s}=e;return s},t=>t.getIn(["contexts","inReplyTos"])],((t,e)=>{let s=i.default.List();return s=s.withMutations((s=>{let a=t;for(;a&&!s.includes(a);)s.unshift(a),a=e.get(a)})),s})),a=Object(g.a)([(t,e)=>{let{id:s}=e;return s},t=>t.getIn(["contexts","replies"]),t=>t.get("statuses")],((t,e,s)=>{let a=[];const o=[t];for(;o.length>0;){let s=o.pop();const i=e.get(s);t!==s&&a.push(s),i&&i.reverse().forEach((e=>{o.includes(e)||a.includes(e)||t===e||o.push(e)}))}let n=a.findIndex((t=>s.get(t).get("in_reply_to_account_id")!==s.get(t).get("account")));return-1!==n&&a.forEach(((t,e)=>{e>n&&s.get(t).get("in_reply_to_account_id")===s.get(t).get("account")&&(a.splice(e,1),a.splice(n,0,t),n+=1)})),i.default.List(a)}));return(o,n)=>{const l=t(o,{id:n.params.statusId});let d=i.default.List(),c=i.default.List();return l&&(d=s(o,{id:l.get("in_reply_to_id")}),c=a(o,{id:l.get("id")})),{isLoading:o.getIn(["statuses",n.params.statusId,"isLoading"]),status:l,ancestorsIds:d,descendantsIds:c,askReplyConfirmation:0!==o.getIn(["compose","text"]).trim().length,domain:o.getIn(["meta","domain"]),pictureInPicture:e(o,{id:n.params.statusId})}}})),Object(_.g)(tt=Z(((et=class extends C.a{constructor(){var t;super(...arguments),t=this,this.state={fullscreen:!1,showMedia:Object(vt.b)(this.props.status),loadedStatusId:void 0},this.handleToggleMediaVisibility=()=>{this.setState({showMedia:!this.state.showMedia})},this.handleFavouriteClick=t=>{const{dispatch:e}=this.props,{signedIn:s}=this.context.identity;s?t.get("favourited")?e(Object(at.v)(t)):e(Object(at.p)(t)):e(Object(P.d)("INTERACTION",{type:"favourite",accountId:t.getIn(["account","id"]),url:t.get("url")}))},this.handlePin=t=>{t.get("pinned")?this.props.dispatch(Object(at.w)(t)):this.props.dispatch(Object(at.s)(t))},this.handleReplyClick=t=>{const{askReplyConfirmation:e,dispatch:s,intl:a}=this.props,{signedIn:i}=this.context.identity;s(i?e?Object(P.d)("CONFIRM",{message:a.formatMessage(kt.replyMessage),confirm:a.formatMessage(kt.replyConfirm),onConfirm:()=>s(Object(it.vb)(t,this.context.router.history))}):Object(it.vb)(t,this.context.router.history):Object(P.d)("INTERACTION",{type:"reply",accountId:t.getIn(["account","id"]),url:t.get("url")}))},this.handleModalReblog=(t,e)=>{this.props.dispatch(Object(at.t)(t,e))},this.handleReblogClick=(t,e)=>{const{dispatch:s}=this.props,{signedIn:a}=this.context.identity;a?t.get("reblogged")?s(Object(at.x)(t)):e&&e.shiftKey||!W.b?this.handleModalReblog(t):s(Object(ct.d)({status:t,onReblog:this.handleModalReblog})):s(Object(P.d)("INTERACTION",{type:"reblog",accountId:t.getIn(["account","id"]),url:t.get("url")}))},this.handleBookmarkClick=t=>{t.get("bookmarked")?this.props.dispatch(Object(at.u)(t)):this.props.dispatch(Object(at.o)(t))},this.handleDeleteClick=function(e,s,a){void 0===a&&(a=!1);const{dispatch:i,intl:o}=t.props;W.e?i(Object(P.d)("CONFIRM",{message:o.formatMessage(a?kt.redraftMessage:kt.deleteMessage),confirm:o.formatMessage(a?kt.redraftConfirm:kt.deleteConfirm),onConfirm:()=>i(Object(m.l)(e.get("id"),s,a))})):i(Object(m.l)(e.get("id"),s,a))},this.handleEditClick=(t,e)=>{this.props.dispatch(Object(m.m)(t.get("id"),e))},this.handleDirectClick=(t,e)=>{this.props.dispatch(Object(it.jb)(t,e))},this.handleMentionClick=(t,e)=>{this.props.dispatch(Object(it.pb)(t,e))},this.handleOpenMedia=(t,e)=>{this.props.dispatch(Object(P.d)("MEDIA",{statusId:this.props.status.get("id"),media:t,index:e}))},this.handleOpenVideo=(t,e)=>{this.props.dispatch(Object(P.d)("VIDEO",{statusId:this.props.status.get("id"),media:t,options:e}))},this.handleHotkeyOpenMedia=t=>{const{status:e}=this.props;t.preventDefault(),e.get("media_attachments").size>0&&("video"===e.getIn(["media_attachments",0,"type"])?this.handleOpenVideo(e.getIn(["media_attachments",0]),{startTime:0}):this.handleOpenMedia(e.get("media_attachments"),0))},this.handleMuteClick=t=>{this.props.dispatch(Object(lt.m)(t))},this.handleConversationMuteClick=t=>{t.get("muted")?this.props.dispatch(Object(m.u)(t.get("id"))):this.props.dispatch(Object(m.p)(t.get("id")))},this.handleToggleHidden=t=>{t.get("hidden")?this.props.dispatch(Object(m.q)(t.get("id"))):this.props.dispatch(Object(m.o)(t.get("id")))},this.handleToggleAll=()=>{const{status:t,ancestorsIds:e,descendantsIds:s}=this.props,a=[t.get("id")].concat(e.toJS(),s.toJS());t.get("hidden")?this.props.dispatch(Object(m.q)(a)):this.props.dispatch(Object(m.o)(a))},this.handleTranslate=t=>{const{dispatch:e}=this.props;t.get("translation")?e(Object(m.t)(t.get("id"))):e(Object(m.s)(t.get("id")))},this.handleBlockClick=t=>{const{dispatch:e}=this.props,s=t.get("account");e(Object(dt.j)(s))},this.handleReport=t=>{this.props.dispatch(Object(rt.a)(t.get("account"),t))},this.handleEmbed=t=>{this.props.dispatch(Object(P.d)("EMBED",{url:t.get("url")}))},this.handleUnmuteClick=t=>{this.props.dispatch(Object(ot.ab)(t.get("id")))},this.handleUnblockClick=t=>{this.props.dispatch(Object(ot.Y)(t.get("id")))},this.handleBlockDomainClick=t=>{this.props.dispatch(Object(P.d)("CONFIRM",{message:Object(a.a)(_.b,{id:"confirmations.domain_block.message",defaultMessage:"Are you really, really sure you want to block the entire {domain}? In most cases a few targeted blocks or mutes are sufficient and preferable. You will not see content from that domain in any public timelines or your notifications. Your followers from that domain will be removed.",values:{domain:Object(a.a)("strong",{},void 0,t)}}),confirm:this.props.intl.formatMessage(kt.blockDomainConfirm),onConfirm:()=>this.props.dispatch(Object(nt.e)(t))}))},this.handleUnblockDomainClick=t=>{this.props.dispatch(Object(nt.h)(t))},this.handleHotkeyMoveUp=()=>{this.handleMoveUp(this.props.status.get("id"))},this.handleHotkeyMoveDown=()=>{this.handleMoveDown(this.props.status.get("id"))},this.handleHotkeyReply=t=>{t.preventDefault(),this.handleReplyClick(this.props.status)},this.handleHotkeyFavourite=()=>{this.handleFavouriteClick(this.props.status)},this.handleHotkeyBoost=()=>{this.handleReblogClick(this.props.status)},this.handleHotkeyMention=t=>{t.preventDefault(),this.handleMentionClick(this.props.status.get("account"))},this.handleHotkeyOpenProfile=()=>{this.context.router.history.push("/@"+this.props.status.getIn(["account","acct"]))},this.handleHotkeyToggleHidden=()=>{this.handleToggleHidden(this.props.status)},this.handleHotkeyToggleSensitive=()=>{this.handleToggleMediaVisibility()},this.handleMoveUp=t=>{const{status:e,ancestorsIds:s,descendantsIds:a}=this.props;if(t===e.get("id"))this._selectChild(s.size-1,!0);else{let e=s.indexOf(t);-1===e?(e=a.indexOf(t),this._selectChild(s.size+e,!0)):this._selectChild(e-1,!0)}},this.handleMoveDown=t=>{const{status:e,ancestorsIds:s,descendantsIds:a}=this.props;if(t===e.get("id"))this._selectChild(s.size+1,!1);else{let e=s.indexOf(t);-1===e?(e=a.indexOf(t),this._selectChild(s.size+e+2,!1)):this._selectChild(e+1,!1)}},this.setRef=t=>{this.node=t},this.onFullScreenChange=()=>{this.setState({fullscreen:Object(ft.d)()})}}componentWillMount(){this.props.dispatch(Object(m.n)(this.props.params.statusId))}componentDidMount(){Object(ft.a)(this.onFullScreenChange)}componentWillReceiveProps(t){t.params.statusId!==this.props.params.statusId&&t.params.statusId&&(this._scrolledIntoView=!1,this.props.dispatch(Object(m.n)(t.params.statusId))),t.status&&t.status.get("id")!==this.state.loadedStatusId&&this.setState({showMedia:Object(vt.b)(t.status),loadedStatusId:t.status.get("id")})}_selectChild(t,e){const s=this.node,a=s.querySelectorAll(".focusable")[t];a&&(e&&s.scrollTop>a.offsetTop?a.scrollIntoView(!0):!e&&s.scrollTop+s.clientHeight<a.offsetTop+a.offsetHeight&&a.scrollIntoView(!1),a.focus())}renderChildren(t){return t.map((t=>Object(a.a)(mt.a,{id:t,onMoveUp:this.handleMoveUp,onMoveDown:this.handleMoveDown,contextType:"thread"},t)))}componentDidUpdate(){if(this._scrolledIntoView)return;const{status:t,ancestorsIds:e}=this.props;if(t&&e&&e.size>0){const t=this.node.querySelectorAll(".focusable")[e.size-1];window.requestAnimationFrame((()=>{t.scrollIntoView(!0)})),this._scrolledIntoView=!0}}componentWillUnmount(){Object(ft.b)(this.onFullScreenChange)}render(){let t,e;const{isLoading:s,status:i,ancestorsIds:o,descendantsIds:l,intl:d,domain:c,multiColumn:r,pictureInPicture:u}=this.props,{fullscreen:p}=this.state;if(s)return Object(a.a)(st.a,{},void 0,Object(a.a)(f.b,{}));if(null===i)return Object(a.a)(st.a,{},void 0,Object(a.a)(pt.a,{multiColumn:r}),Object(a.a)(b.a,{}));o&&o.size>0&&(t=Object(a.a)("div",{},void 0,this.renderChildren(o))),l&&l.size>0&&(e=Object(a.a)("div",{},void 0,this.renderChildren(l)));const g=-1===i.getIn(["account","acct"],"").indexOf("@"),m=!i.getIn(["account","noindex"]),v={moveUp:this.handleHotkeyMoveUp,moveDown:this.handleHotkeyMoveDown,reply:this.handleHotkeyReply,favourite:this.handleHotkeyFavourite,boost:this.handleHotkeyBoost,mention:this.handleHotkeyMention,openProfile:this.handleHotkeyOpenProfile,toggleHidden:this.handleHotkeyToggleHidden,toggleSensitive:this.handleHotkeyToggleSensitive,openMedia:this.handleHotkeyOpenMedia};return Object(a.a)(st.a,{bindToDocument:!r,label:d.formatMessage(kt.detailedStatus)},void 0,Object(a.a)(gt.a,{showBackButton:!0,multiColumn:r,extraButton:Object(a.a)("button",{type:"button",className:"column-header__button",title:d.formatMessage(i.get("hidden")?kt.revealAll:kt.hideAll),"aria-label":d.formatMessage(i.get("hidden")?kt.revealAll:kt.hideAll),onClick:this.handleToggleAll},void 0,Object(a.a)(D.a,{id:i.get("hidden")?"eye-slash":"eye"}))}),Object(a.a)(ut.a,{scrollKey:"thread"},void 0,n.a.createElement("div",{className:h()("scrollable",{fullscreen:p}),ref:this.setRef},t,Object(a.a)(bt.HotKeys,{handlers:v},void 0,Object(a.a)("div",{className:h()("focusable","detailed-status__wrapper"),tabIndex:"0","aria-label":Object(vt.c)(d,i,!1)},void 0,Object(a.a)($,{status:i,onOpenVideo:this.handleOpenVideo,onOpenMedia:this.handleOpenMedia,onToggleHidden:this.handleToggleHidden,onTranslate:this.handleTranslate,domain:c,showMedia:this.state.showMedia,onToggleMediaVisibility:this.handleToggleMediaVisibility,pictureInPicture:u},"details-"+i.get("id")),Object(a.a)(X,{status:i,onReply:this.handleReplyClick,onFavourite:this.handleFavouriteClick,onReblog:this.handleReblogClick,onBookmark:this.handleBookmarkClick,onDelete:this.handleDeleteClick,onEdit:this.handleEditClick,onDirect:this.handleDirectClick,onMention:this.handleMentionClick,onMute:this.handleMuteClick,onUnmute:this.handleUnmuteClick,onMuteConversation:this.handleConversationMuteClick,onBlock:this.handleBlockClick,onUnblock:this.handleUnblockClick,onBlockDomain:this.handleBlockDomainClick,onUnblockDomain:this.handleUnblockDomainClick,onReport:this.handleReport,onPin:this.handlePin,onEmbed:this.handleEmbed},"action-bar-"+i.get("id")))),e)),Object(a.a)(Ot.a,{},void 0,Object(a.a)("title",{},void 0,(t=>{const e=t.getIn(["account","display_name"]),s=t.getIn(["account","username"]),a=0===e.trim().length?s:e,i=t.get("search_index");return`${a}: "${o=i,n=30,o.length>n?o.slice(0,n)+"…":o}"`;var o,n})(i)),Object(a.a)("meta",{name:"robots",content:g&&m?"all":"noindex"})))}}).contextTypes={router:c.a.object,identity:c.a.object},et.propTypes={params:c.a.object.isRequired,dispatch:c.a.func.isRequired,status:p.a.map,isLoading:c.a.bool,ancestorsIds:p.a.list,descendantsIds:p.a.list,intl:c.a.object.isRequired,askReplyConfirmation:c.a.bool,multiColumn:c.a.bool,domain:c.a.string.isRequired,pictureInPicture:p.a.contains({inUse:c.a.bool,available:c.a.bool})},tt=et))||tt)||tt)}}]);
//# sourceMappingURL=status-1ff0a6183cdf87a342c8.chunk.js.map