{"version":3,"sources":["webpack:///./app/javascript/mastodon/features/interaction_modal/index.js"],"names":["Copypaste","React","PureComponent","state","copied","setRef","c","this","input","handleInputClick","setState","focus","select","setSelectionRange","value","length","handleButtonClick","props","navigator","clipboard","writeText","blur","timeout","setTimeout","componentWillUnmount","clearTimeout","render","className","classNames","type","ref","readOnly","onClick","id","defaultMessage","InteractionModal","connect","accountId","displayNameHtml","getIn","dispatch","onSignupClick","closeModal","openModal","handleSignupClick","url","name","dangerouslySetInnerHTML","__html","title","actionDescription","icon","signupButton","values","registrationsOpen","href"],"mappings":"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","file":"js/modals/interaction_modal-9f1b3bc4e6f3363dda82.chunk.js","sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport { FormattedMessage } from 'react-intl';\nimport { registrationsOpen } from 'mastodon/initial_state';\nimport { connect } from 'react-redux';\nimport Icon from 'mastodon/components/icon';\nimport classNames from 'classnames';\nimport { openModal, closeModal } from 'mastodon/actions/modal';\n\nconst mapStateToProps = (state, { accountId }) => ({\n  displayNameHtml: state.getIn(['accounts', accountId, 'display_name_html']),\n});\n\nconst mapDispatchToProps = (dispatch) => ({\n  onSignupClick() {\n    dispatch(closeModal());\n    dispatch(openModal('CLOSED_REGISTRATIONS'));\n  },\n});\n\nclass Copypaste extends React.PureComponent {\n\n  static propTypes = {\n    value: PropTypes.string,\n  };\n\n  state = {\n    copied: false,\n  };\n\n  setRef = c => {\n    this.input = c;\n  }\n\n  handleInputClick = () => {\n    this.setState({ copied: false });\n    this.input.focus();\n    this.input.select();\n    this.input.setSelectionRange(0, this.input.value.length);\n  }\n\n  handleButtonClick = () => {\n    const { value } = this.props;\n    navigator.clipboard.writeText(value);\n    this.input.blur();\n    this.setState({ copied: true });\n    this.timeout = setTimeout(() => this.setState({ copied: false }), 700);\n  }\n\n  componentWillUnmount () {\n    if (this.timeout) clearTimeout(this.timeout);\n  }\n\n  render () {\n    const { value } = this.props;\n    const { copied } = this.state;\n\n    return (\n      <div className={classNames('copypaste', { copied })}>\n        <input\n          type='text'\n          ref={this.setRef}\n          value={value}\n          readOnly\n          onClick={this.handleInputClick}\n        />\n\n        <button className='button' onClick={this.handleButtonClick}>\n          {copied ? <FormattedMessage id='copypaste.copied' defaultMessage='Copied' /> : <FormattedMessage id='copypaste.copy' defaultMessage='Copy' />}\n        </button>\n      </div>\n    );\n  }\n\n}\n\nexport default @connect(mapStateToProps, mapDispatchToProps)\nclass InteractionModal extends React.PureComponent {\n\n  static propTypes = {\n    displayNameHtml: PropTypes.string,\n    url: PropTypes.string,\n    type: PropTypes.oneOf(['reply', 'reblog', 'favourite', 'follow']),\n    onSignupClick: PropTypes.func.isRequired,\n  };\n\n  handleSignupClick = () => {\n    this.props.onSignupClick();\n  }\n\n  render () {\n    const { url, type, displayNameHtml } = this.props;\n\n    const name = <bdi dangerouslySetInnerHTML={{ __html: displayNameHtml }} />;\n\n    let title, actionDescription, icon;\n\n    switch(type) {\n    case 'reply':\n      icon = <Icon id='reply' />;\n      title = <FormattedMessage id='interaction_modal.title.reply' defaultMessage=\"Reply to {name}'s post\" values={{ name }} />;\n      actionDescription = <FormattedMessage id='interaction_modal.description.reply' defaultMessage='With an account on Mastodon, you can respond to this post.' />;\n      break;\n    case 'reblog':\n      icon = <Icon id='retweet' />;\n      title = <FormattedMessage id='interaction_modal.title.reblog' defaultMessage=\"Boost {name}'s post\" values={{ name }} />;\n      actionDescription = <FormattedMessage id='interaction_modal.description.reblog' defaultMessage='With an account on Mastodon, you can boost this post to share it with your own followers.' />;\n      break;\n    case 'favourite':\n      icon = <Icon id='star' />;\n      title = <FormattedMessage id='interaction_modal.title.favourite' defaultMessage=\"Favourite {name}'s post\" values={{ name }} />;\n      actionDescription = <FormattedMessage id='interaction_modal.description.favourite' defaultMessage='With an account on Mastodon, you can favourite this post to let the author know you appreciate it and save it for later.' />;\n      break;\n    case 'follow':\n      icon = <Icon id='user-plus' />;\n      title = <FormattedMessage id='interaction_modal.title.follow' defaultMessage='Follow {name}' values={{ name }} />;\n      actionDescription = <FormattedMessage id='interaction_modal.description.follow' defaultMessage='With an account on Mastodon, you can follow {name} to receive their posts in your home feed.' values={{ name }} />;\n      break;\n    }\n\n    let signupButton;\n\n    if (registrationsOpen) {\n      signupButton = (\n        <a href='/auth/sign_up' className='button button--block button-tertiary'>\n          <FormattedMessage id='sign_in_banner.create_account' defaultMessage='Create account' />\n        </a>\n      );\n    } else {\n      signupButton = (\n        <button className='button button--block button-tertiary' onClick={this.handleSignupClick}>\n          <FormattedMessage id='sign_in_banner.create_account' defaultMessage='Create account' />\n        </button>\n      );\n    }\n\n    return (\n      <div className='modal-root__modal interaction-modal'>\n        <div className='interaction-modal__lead'>\n          <h3><span className='interaction-modal__icon'>{icon}</span> {title}</h3>\n          <p>{actionDescription} <FormattedMessage id='interaction_modal.preamble' defaultMessage=\"Since Mastodon is decentralized, you can use your existing account hosted by another Mastodon server or compatible platform if you don't have an account on this one.\" /></p>\n        </div>\n\n        <div className='interaction-modal__choices'>\n          <div className='interaction-modal__choices__choice'>\n            <h3><FormattedMessage id='interaction_modal.on_this_server' defaultMessage='On this server' /></h3>\n            <a href='/auth/sign_in' className='button button--block'><FormattedMessage id='sign_in_banner.sign_in' defaultMessage='Sign in' /></a>\n            {signupButton}\n          </div>\n\n          <div className='interaction-modal__choices__choice'>\n            <h3><FormattedMessage id='interaction_modal.on_another_server' defaultMessage='On a different server' /></h3>\n            <p><FormattedMessage id='interaction_modal.other_server_instructions' defaultMessage='Copy and paste this URL into the search field of your favourite Mastodon app or the web interface of your Mastodon server.' /></p>\n            <Copypaste value={url} />\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n}\n"],"sourceRoot":""}